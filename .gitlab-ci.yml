variables:
    PLUGIN_NAME: 'OASwitchboardForOJS'
    GIT_SUBMODULE_STRATEGY: normal

include:
  - project: 'documentacao-e-tarefas/modelosparaintegracaocontinua'
    ref: main
    file:
      - 'templates/groups/pkp_plugin.yml'
      - 'templates/groups/ojs_plugins_unit_tests_model.yml'
      - 'templates/groups/ojs_plugins_cypress_tests_model.yml'

.unit_test_template:
  before_script:
    - cat .gitmodules
    - cat .git/config
    - ls -laR subprojects/gvdb
    - sed -i 's/api_key_secret = ""/api_key_secret = "$API_KEY_SECRET"/' /var/www/ojs/config.inc.php

.integration_tests_template:
  before_script:
    - export CYPRESS_OASPassword="$(echo $CYPRESS_OASPassword | base64 -d)"
    - sed -i 's/api_key_secret = ""/api_key_secret = "$API_KEY_SECRET"/' /var/www/ojs/config.inc.php